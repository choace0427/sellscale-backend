"""Rename columns, foreign key constraints, etc.

Revision ID: d7282ead8c00
Revises: fc4444155925
Create Date: 2024-02-29 15:17:52.401167

"""

from alembic import op
import sqlalchemy as sa


# revision identifiers, used by Alembic.
revision = "d7282ead8c00"
down_revision = "fc4444155925"
branch_labels = None
depends_on = None


def upgrade():
    # ### commands auto generated by Alembic - please adjust! ###

    # Table: client_asset_archetype_reason_mapping, formerly client_archetype_asset_reason_mapping
    # 1. Rename client_archetype_asset_id to client_asset_id
    # 2. Drop the foreign key constraint client_archetype_asset_reason_ma_client_archetype_asset_id_fkey
    # 3. Create a new foreign key constraint with the same name but with the new column name
    op.alter_column(
        "client_asset_archetype_reason_mapping",
        "client_archetype_asset_id",
        new_column_name="client_asset_id",
    )
    op.drop_constraint(
        "client_archetype_asset_reason_ma_client_archetype_asset_id_fkey",
        "client_asset_archetype_reason_mapping",
        type_="foreignkey",
    )
    op.create_foreign_key(
        None,
        "client_asset_archetype_reason_mapping",
        "client_assets",
        ["client_asset_id"],
        ["id"],
    )

    # Table: email_sequence_step_to_asset_mapping
    # 1. Rename client_archetype_assets_id to client_assets_id
    # 2. Drop the foreign key constraint email_sequence_step_to_asset_ma_client_archetype_assets_id_fkey
    # 3. Create a new foreign key constraint with the same name but with the new column name
    op.alter_column(
        "email_sequence_step_to_asset_mapping",
        "client_archetype_assets_id",
        new_column_name="client_assets_id",
    )
    op.drop_constraint(
        "email_sequence_step_to_asset_ma_client_archetype_assets_id_fkey",
        "email_sequence_step_to_asset_mapping",
        type_="foreignkey",
    )
    op.create_foreign_key(
        None,
        "email_sequence_step_to_asset_mapping",
        "client_assets",
        ["client_assets_id"],
        ["id"],
    )

    # ### end Alembic commands ###


def downgrade():
    # ### commands auto generated by Alembic - please adjust! ###

    # Table: email_sequence_step_to_asset_mapping
    # 1. Rename client_assets_id to client_archetype_assets_id
    # 2. Drop the foreign key constraint email_sequence_step_to_asset_mapping_client_assets_id_fkey
    # 3. Create a new foreign key constraint with the same name but with the new column name
    op.alter_column(
        "email_sequence_step_to_asset_mapping",
        "client_assets_id",
        new_column_name="client_archetype_assets_id",
    )
    op.drop_constraint(
        "email_sequence_step_to_asset_ma_client_assets_id_fkey",
        "email_sequence_step_to_asset_mapping",
        type_="foreignkey",
    )
    op.create_foreign_key(
        None,
        "email_sequence_step_to_asset_mapping",
        "client_assets",
        ["client_archetype_assets_id"],
        ["id"],
    )

    # Table: client_asset_archetype_reason_mapping
    # 1. Rename client_asset_id to client_archetype_asset_id
    # 2. Drop the foreign key constraint client_asset_archetype_reason_ma_client_asset_id_fkey
    # 3. Create a new foreign key constraint with the same name but with the new column name
    op.alter_column(
        "client_asset_archetype_reason_mapping",
        "client_asset_id",
        new_column_name="client_archetype_asset_id",
    )
    op.drop_constraint(
        "client_archetype_asset_reason_ma_client_asset_id_fkey",
        "client_asset_archetype_reason_mapping",
        type_="foreignkey",
    )
    op.create_foreign_key(
        None,
        "client_asset_archetype_reason_mapping",
        "client_assets",
        ["client_archetype_asset_id"],
        ["id"],
    )

    # ### end Alembic commands ###
